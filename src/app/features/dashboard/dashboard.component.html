<p-toast></p-toast>
<p-confirmDialog header="Confirm Delete" icon="pi pi-exclamation-triangle"></p-confirmDialog>

<div class="hidden sm:block card p-6 rounded-lg shadow-lg bg-[#f9fafb] max-w-full mx-auto">
  <div class="flex items-center justify-between w-full py-3 px-2">
    <span class="text-2xl font-semibold text-gray-800"> Welcome, {{ session?.userName }}! </span>

    <h1
      class="text-4xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-green-400 via-blue-500 to-purple-500 text-center center"
    >
      &gt; Marketko
    </h1>

   <div>
     <button
    pButton
    icon="pi pi-sign-out"
    class="p-button-rounded p-button-text text-gray-600 hover:text-gray-800"
    (click)="logout()"
  ></button>

    </div>
  </div>
</div>

<div
  class="block sm:hidden card p-6 rounded-lg shadow-lg bg-[#f9fafb] max-w-full mx-auto text-center"
>
  <div class="flex items-center justify-between w-full py-3 px-2">

    <h1
      class="text-3xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-green-400 via-blue-500 to-purple-500 m-0"
    >
      &gt; Marketko
    </h1>

    <div class="flex items-center gap-2">

      <button
        pButton
        icon="pi pi-sign-out"
        class="p-button-rounded p-button-text text-gray-600 hover:text-gray-800"
        (click)="logout()"
      ></button>

     
      

    </div>

  </div>

  <span class="text-xl font-bold text-gray-700 mb-3 block">
    Welcome, {{ session?.userName }}!
  </span>
</div>


<div class="card p-4 shadow-lg bg-white rounded-lg max-w-7xl mx-auto mt-6">
  <div
    class="flex justify-between items-center mb-4 bg-gradient-to-r from-green-400 to-blue-500 text-white text-lg p-3 rounded-t-lg"
  >
  <div class=" sm:flex-1 block">
<h2 class="text-3xl font-bold ">Products List</h2>
  </div>
    
    <button
      pButton
      label="Create Product"
      icon="pi pi-plus"
      class="p-button-success  whitespace-nowrap block"
      (click)="creatProduct()"
    ></button>
  </div>

 <div class="flex flex-col md:flex-row justify-between mb-2 gap-2 items-stretch">
  <p-iconField iconPosition="left" class="flex-1 md:w-3/4 h-full">
    <p-inputIcon styleClass="pi pi-search" />
    <input
      type="text"
      pInputText
      placeholder="Search by name, slug, sku..."
      (input)="onSearchChange($event.target.value)"
      class="p-inputtext-sm w-full h-14"
    />
  </p-iconField>

  <p-select
    [options]="statusOptions"
    placeholder="Select status"
    (onChange)="onStatusFilterChange($event.value)"
    class="p-inputtext-sm w-full md:w-1/4 h-1/3"
  >
  </p-select>
</div>



  <p-table
    [value]="products()"
    [lazy]="true"
    [paginator]="true"
    [rows]="perPage()"
    [totalRecords]="totalItems()"
    (onLazyLoad)="onPageChange($event)"
    [loading]="isLoading()"
    dataKey="id"
    [rowsPerPageOptions]="perPageOptions"
    responsiveLayout="scroll"
    styleClass="shadow-md rounded-lg overflow-hidden"
  >
    <ng-template pTemplate="header">
      <tr class="bg-gradient-to-r from-green-300 to-blue-300 text-gray-800 font-semibold">
        <th>Image</th>
        <th>Name</th>
        <th>SKU</th>
        <th>Slug</th>
        <th>Price</th>
        <th>Stock</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-product>
      <tr
        class="hover:bg-gray-50 cursor-pointer transition row-hover"
        (click)="viewProduct(product)"
      >
        <td>
          <img
            *ngIf="product.thumbnail_url"
            [src]="product.thumbnail_url"
            alt="{{ product.name }}"
            class="w-12 h-12 object-cover rounded-md"
          />
        </td>
        <td class="text-gray-800 font-medium">{{ product.name }}</td>
        <td>{{ product.sku }}</td>
        <td>{{ product.slug }}</td>
        <td>{{ product.price }} {{ product.currency }}</td>
        <td>{{ product.stock }}</td>
        <td>
          <p-tag
            [value]="product.is_active ? 'Active' : 'Inactive'"
            [severity]="product.is_active ? 'success' : 'danger'"
          ></p-tag>
        </td>
        <td>
          <button
            pButton
            icon="pi pi-pencil"
            severity="warn"
            size="small"
            class="md:mr-2 md:mb-2 "
            (click)="editProduct(product); $event.stopPropagation()"
          ></button>
          <button
            pButton
            icon="pi pi-trash"
            severity="danger"
            size="small"
            (click)="deleteProduct(product); $event.stopPropagation()"
          ></button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="8" class="text-center text-gray-500">No products found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
